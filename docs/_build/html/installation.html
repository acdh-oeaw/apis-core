

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Installation &mdash; APIS 0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="APIS 0.1 documentation" href="index.html"/>
        <link rel="next" title="Data Model" href="data_model.html"/>
        <link rel="prev" title="Welcome to APIS’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> APIS
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a></li>
<li class="toctree-l2"><a class="reference internal" href="#git-and-submodules">Git and submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id1">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#serving-apis-via-apache-wsgi">Serving APIS via Apache WSGI</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_model.html">Data Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="internal_api.html">Internal API</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_documentation.html">User documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">APIS</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Installation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/installation.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="prerequisites">
<h2>Prerequisites<a class="headerlink" href="#prerequisites" title="Permalink to this headline">¶</a></h2>
<p>APIS webapp needs Python 3.5+ and several python packages that can be easily installed by using pip.</p>
<p>Create a new virtualenv and activate it:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">virtualenv -p pyton3.5 your_virtualenv_name</span>
<span class="go">source your_virtualenv_name/bin/activate</span>
</pre></div>
</div>
</div>
<div class="section" id="git-and-submodules">
<h2>Git and submodules<a class="headerlink" href="#git-and-submodules" title="Permalink to this headline">¶</a></h2>
<p>We use the system in several different projects. To allow for high configurability while keeping it simple we decided
to split the system in several git submodules:</p>
<ul class="simple">
<li>apis-core: the main application code</li>
<li>apis-PROJECTNAME-settings (for the main system used in apis project we omit the PROJECTNAME in the repo names): The settings folder of the various projects. These contain not only the app settings (e.g.
db user, db password etc.) but also the settings for the autocompletes and the RDF parsers.</li>
<li>apis-PROJECTNAME-webpage: The webpage app of the respective project. Seperating these base templates and javascripts
from the rest of the app allows us to give every project its very own look.</li>
</ul>
<p>If you want to get a basic running system that you can work from, you can clone apis-apis and initialize the submodules:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">recursive</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">acdh</span><span class="o">-</span><span class="n">oeaw</span><span class="o">/</span><span class="n">apis</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
<p>After that you need to set two symlinks:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">apisapp</span><span class="o">/</span><span class="n">apis</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">../../</span><span class="n">apis</span><span class="o">-</span><span class="n">settings</span> <span class="n">settings</span>
<span class="n">cd</span> <span class="o">..</span>
<span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">../</span><span class="n">apis</span><span class="o">-</span><span class="n">webpage</span> <span class="n">webpage</span>
</pre></div>
</div>
<p>Now you have the correct folder structure in place and are good to go on with installing</p>
</div>
<div class="section" id="id1">
<h2>Installation<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h2>
<p>Change to the directory you have downloaded APIS to and install the needed Python packages:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">apisapp</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>Next you need to create a file called copy the <code class="docutils literal"><span class="pre">APIS_directory/apisapp/apis/settings/dummysettings.py</span></code> file to another name.
We suggest <code class="docutils literal"><span class="pre">server.py</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cp</span> <span class="n">APIS_directory</span><span class="o">/</span><span class="n">apisapp</span><span class="o">/</span><span class="n">apis</span><span class="o">/</span><span class="n">settings</span><span class="o">/</span><span class="n">dummysettings</span><span class="o">.</span><span class="n">py</span> <span class="n">APIS_directory</span><span class="o">/</span><span class="n">apisapp</span><span class="o">/</span><span class="n">apis</span><span class="o">/</span><span class="n">settings</span><span class="o">/</span><span class="n">server</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>Edit <code class="docutils literal"><span class="pre">server.py</span></code> to your needs. E.g. if you intend to use Mysql it should look something like:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">.base</span> <span class="k">import</span> <span class="o">*</span>

<span class="n">SECRET_KEY</span> <span class="o">=</span> <span class="s1">&#39;asdaaserffsdfi&#39;</span>
<span class="c1"># SECURITY WARNING: don&#39;t run with debug turned on in production!</span>
<span class="n">DEBUG</span> <span class="o">=</span> <span class="kc">True</span>

<span class="n">DATABASES</span> <span class="o">=</span> <span class="p">{</span>
<span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="p">{</span>
    <span class="s1">&#39;ENGINE&#39;</span><span class="p">:</span> <span class="s1">&#39;django.db.backends.mysql&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NAME&#39;</span><span class="p">:</span> <span class="s1">&#39;databsename&#39;</span><span class="p">,</span>
    <span class="s1">&#39;USER&#39;</span><span class="p">:</span> <span class="s1">&#39;dtabaseuser&#39;</span><span class="p">,</span>
    <span class="s1">&#39;PASSWORD&#39;</span><span class="p">:</span> <span class="s1">&#39;databasepassword&#39;</span><span class="p">,</span>
    <span class="s1">&#39;HOST&#39;</span><span class="p">:</span> <span class="s1">&#39;localhost&#39;</span><span class="p">,</span>   <span class="c1"># Or an IP Address that your DB is hosted on</span>
    <span class="s1">&#39;PORT&#39;</span><span class="p">:</span> <span class="s1">&#39;3306&#39;</span><span class="p">,</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Dont forget to set <code class="docutils literal"><span class="pre">DEBUG</span> <span class="pre">=</span> <span class="pre">False</span></code> once you are in production.</p>
<p>Once the database connection is set run:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">python manage.py migrate --settings=apis.settings.server</span>
</pre></div>
</div>
<p>For convenience we suggest you alter <code class="docutils literal"><span class="pre">manage.py</span></code> to:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s2">&quot;DJANGO_SETTINGS_MODULE&quot;</span><span class="p">,</span> <span class="s2">&quot;apis.settings.server&quot;</span><span class="p">)</span>

    <span class="kn">from</span> <span class="nn">django.core.management</span> <span class="k">import</span> <span class="n">execute_from_command_line</span>

    <span class="n">execute_from_command_line</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">)</span>
</pre></div>
</div>
<p>Once that is done you dont have to incluse <code class="docutils literal"><span class="pre">--settings=apis.settings.server</span></code> in your commands anymore.</p>
<p>Next we migrate the APIS internal tables:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">python manage.py makemigrations metainfo entities relations vocabularies highlighter labels webpage</span>
<span class="go">python manage.py migrate</span>
</pre></div>
</div>
<p>and create a superuser:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">python manage.py createsuperuser</span>
</pre></div>
</div>
<p>answer the questions and you should be good to go:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="go">python manage.py runserver</span>
</pre></div>
</div>
<p>should bring up a development server window with your new apis instance.</p>
</div>
<div class="section" id="serving-apis-via-apache-wsgi">
<h2>Serving APIS via Apache WSGI<a class="headerlink" href="#serving-apis-via-apache-wsgi" title="Permalink to this headline">¶</a></h2>
<p>If you plan to use APIS in production you should deploy it via a proper webserver. We use <a class="reference external" href="https://httpd.apache.org/">Apache</a> and <code class="docutils literal"><span class="pre">mod_wsgi</span></code> to
do so. Our apche virtualhost config looks something like:</p>
<div class="highlight-aconf"><div class="highlight"><pre><span></span><span class="nt">&lt;VirtualHost</span> <span class="s">*:80</span><span class="nt">&gt;</span>
   <span class="nb">ServerName</span> server_name
   <span class="nb">ServerAlias</span> server_alias #alias names if needed
   <span class="nb">DocumentRoot</span> <span class="sx">/var/www/html</span> #document root of your installation
   <span class="nb">WSGIDaemonProcess</span> apis.eos.arz.oeaw.ac.at <span class="k">user</span>=#1025 <span class="k">group</span>=#1025 python-path=/var/www/html/
   <span class="nb">WSGIProcessGroup</span> apis.eos.arz.oeaw.ac.at <span class="k">user</span>=#1025 <span class="k">group</span>=#1025 python-path=/var/www/html/
   <span class="nb">WSGIScriptAlias</span> / <span class="sx">/var/www/html/apisapp/apis/wsgi.py</span>
   <span class="nt">&lt;Directory</span> <span class="s">/var/www/html</span><span class="nt">&gt;</span>
     <span class="nb">Require</span> <span class="k">all</span> granted
     <span class="nb">AllowOverride</span> <span class="k">All</span>
     <span class="nb">Options</span> <span class="k">All</span> granted
   <span class="nt">&lt;/Directory&gt;</span>
   <span class="nb">Alias</span> <span class="sx">/static</span> <span class="sx">/var/www/html/apisapp/static_dir</span> #static directories to server via Apache
   <span class="nb">Alias</span> <span class="sx">/downloads</span> <span class="sx">/var/www/html/apisapp/downloads</span>
<span class="nt">&lt;/VirtualHost&gt;</span>
</pre></div>
</div>
<p>If the database is connected and the virtualhost is configured you are good to go:</p>
<div class="highlight-bash"><div class="highlight"><pre><span></span>service apache2 reload
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="data_model.html" class="btn btn-neutral float-right" title="Data Model" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to APIS’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2017, Matthias Schlögl.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>